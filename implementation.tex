\section{実装}
{\system} は MacRuby で記述された Mac 用の IME であり、ソースが 500 行程度とコンパクトであるにもかかわらず、他の IME に見られない機能を実装しており、本論文のような実験も容易である。

\subsection{MacRuby}
MacRuby は、Mac 用のアプリケーションを開発するために拡張された Ruby 実行環境であり、Mac の Objective-C ライブラリを Ruby で扱うことが出来る。
{\system} では、日本語などの入力を補助するフレームワークである InputMethodKit Framework を MacRuby から呼び出すことによって基本的な IME の機能を実装している。

\subsection{{\system}が受け取るキー入力}
エディタが編集機能のために用いる、ControlやCommandなどの修飾キーはIMEがハンドルしないのが普通であるが、
{\system}では、一部のファンクションキーと修飾キーの入力を受け取り、共通化されたテキスト編集操作を実現している。

{\system} のように、修飾キーの一部をハンドルする実装を行った場合、修飾キーの入力はエディタに送出されないため、エディタが同じキー入力を編集操作に割り当てていても、機能衝突が起こることはない。

\subsection{実装の課題}
しかし、ブロック移動やインデントの処理をあらゆる テキストエリアで行うためには、テキストフィールドに 入力されている全文をIMEが取得する必要があり、InputMethodKit はこの機能を備えていない。

{\system} では、ブロック移動やインデントのコマンドが入力された際に、Mac OSXに実装されている、テキストエリアの全文を選択状態にするコマンドをAppleScriptにより送信している。
これによりテキストエリアの全文をInputMethodKitにより読み込み、
全文を書き換えることで、テキスト編集の機能を実現している。
しかし、このような手法で実装できる編集機能には限界があり、課題が残っている。
